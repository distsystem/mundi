diff --git a/flashinfer/jit/cpp_ext.py b/flashinfer/jit/cpp_ext.py
index 749df0d..afa5a3c 100644
--- a/flashinfer/jit/cpp_ext.py
+++ b/flashinfer/jit/cpp_ext.py
@@ -115,6 +115,12 @@ def generate_ninja_build_for_op(
     cuda_home = CUDA_HOME or "/usr/local/cuda"
     nvcc = os.environ.get("PYTORCH_NVCC", "$cuda_home/bin/nvcc")
 
+    ldflags = (
+        [flag for flag in ldflags if not flag.startswith("-Wl,")]
+        if needs_device_linking
+        else ldflags
+    )
+
     lines = [
         "ninja_required_version = 1.3",
         f"name = {name}",
